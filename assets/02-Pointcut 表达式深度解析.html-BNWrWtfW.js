import{_ as s}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as a,a as t,o as n}from"./app-DRdujVEo.js";const e={};function h(l,i){return n(),a("div",null,i[0]||(i[0]=[t(`<h2 id="什么是切点表达式" tabindex="-1"><a class="header-anchor" href="#什么是切点表达式"><span>什么是切点表达式?</span></a></h2><p><strong>切点表达式（Pointcut Expression）</strong> 是 Spring AOP 中用于定义&quot;在哪里&quot;应用切面逻辑的规则。它通过特定的语法来匹配目标方法或类型。</p><p>简单来说，切点表达式就像一个过滤器，它告诉 Spring：</p><ul><li>哪些类的哪些方法需要被拦截</li><li>在什么条件下触发切面逻辑</li><li>如何精确定位到目标连接点</li></ul><p><strong>核心概念</strong>：</p><ul><li><strong>连接点（Join Point）</strong>：程序执行过程中的某个特定点，如方法调用、异常抛出等</li><li><strong>切点（Pointcut）</strong>：匹配连接点的表达式，决定了切面在何处执行</li><li><strong>切面（Aspect）</strong>：切点和通知（Advice）的组合</li></ul><h2 id="pointcut表达式语法详解" tabindex="-1"><a class="header-anchor" href="#pointcut表达式语法详解"><span>Pointcut表达式语法详解</span></a></h2><h3 id="execution-方法执行匹配" tabindex="-1"><a class="header-anchor" href="#execution-方法执行匹配"><span>execution：方法执行匹配</span></a></h3><p><strong>定义</strong>：最常用的切点表达式，用于匹配方法执行的连接点。</p><h4 id="语法结构" tabindex="-1"><a class="header-anchor" href="#语法结构"><span>语法结构</span></a></h4><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-java"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">execution</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">(modifiers</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">-</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">pattern</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">?</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;"> ret</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">-</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">type</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">-</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">pattern declaring</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">-</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">type</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">-</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">pattern</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">?</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;"> name</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">-</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">pattern</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">(param</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">-</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">pattern) throws</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">-</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">pattern</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">?</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><table><thead><tr><th>部分</th><th>说明</th><th>必需</th></tr></thead><tbody><tr><td><code>modifiers-pattern</code></td><td>修饰符模式（public、protected 等）</td><td>❌</td></tr><tr><td><code>ret-type-pattern</code></td><td>返回值类型模式</td><td>✅</td></tr><tr><td><code>declaring-type-pattern</code></td><td>声明类型模式（类的全限定名）</td><td>❌</td></tr><tr><td><code>name-pattern</code></td><td>方法名模式</td><td>✅</td></tr><tr><td><code>param-pattern</code></td><td>参数模式</td><td>✅</td></tr><tr><td><code>throws-pattern</code></td><td>异常模式</td><td>❌</td></tr></tbody></table><p><strong>基础示例</strong></p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-java"><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">@</span><span style="--shiki-light:#A626A4;--shiki-dark:#E5C07B;">Aspect</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">@</span><span style="--shiki-light:#A626A4;--shiki-dark:#E5C07B;">Component</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">public</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> class</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> ExecutionExamples</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">    </span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    // ========== 1. 匹配所有 public 方法 ==========</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    @</span><span style="--shiki-light:#A626A4;--shiki-dark:#E5C07B;">Pointcut</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;execution(public * *(..))&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">)</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    public</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> void</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> allPublicMethods</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {}</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">    </span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    // ========== 2. 匹配特定返回值类型 ==========</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    @</span><span style="--shiki-light:#A626A4;--shiki-dark:#E5C07B;">Pointcut</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;execution(String *(..))&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">)  </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">// 返回 String</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    public</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> void</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> stringReturnMethods</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {}</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">    </span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    @</span><span style="--shiki-light:#A626A4;--shiki-dark:#E5C07B;">Pointcut</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;execution(void *(..))&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">)  </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">// 返回 void</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    public</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> void</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> voidReturnMethods</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {}</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">    </span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    @</span><span style="--shiki-light:#A626A4;--shiki-dark:#E5C07B;">Pointcut</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;execution(* *(..))&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">)  </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">// 任意返回值</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    public</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> void</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> anyReturnMethods</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {}</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">    </span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    // ========== 3. 匹配特定类的方法 ==========</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    @</span><span style="--shiki-light:#A626A4;--shiki-dark:#E5C07B;">Pointcut</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;execution(* com.example.service.UserService.*(..))&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">)</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    public</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> void</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> userServiceMethods</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {}</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">    </span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    // ========== 4. 匹配特定方法名 ==========</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    @</span><span style="--shiki-light:#A626A4;--shiki-dark:#E5C07B;">Pointcut</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;execution(* com.example.service.UserService.createUser(..))&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">)</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    public</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> void</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> createUserMethod</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {}</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">    </span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    @</span><span style="--shiki-light:#A626A4;--shiki-dark:#E5C07B;">Pointcut</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;execution(* com.example.service.UserService.get*(..))&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">)  </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">// get 开头</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    public</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> void</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> getterMethods</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {}</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">    </span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    @</span><span style="--shiki-light:#A626A4;--shiki-dark:#E5C07B;">Pointcut</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;execution(* com.example.service.UserService.set*(..))&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">)  </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">// set 开头</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    public</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> void</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> setterMethods</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {}</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">    </span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    // ========== 5. 匹配特定参数 ==========</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    @</span><span style="--shiki-light:#A626A4;--shiki-dark:#E5C07B;">Pointcut</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;execution(* com.example.service.UserService.createUser(String))&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">)  </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">// 单个 String 参数</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    public</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> void</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> createUserWithString</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {}</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">    </span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    @</span><span style="--shiki-light:#A626A4;--shiki-dark:#E5C07B;">Pointcut</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;execution(* com.example.service.UserService.createUser(String, int))&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">)  </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">// String 和 int 参数</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    public</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> void</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> createUserWithStringAndInt</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {}</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">    </span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    @</span><span style="--shiki-light:#A626A4;--shiki-dark:#E5C07B;">Pointcut</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;execution(* com.example.service.UserService.createUser(..))&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">)  </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">// 任意参数</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    public</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> void</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> createUserWithAnyParams</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {}</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">    </span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    @</span><span style="--shiki-light:#A626A4;--shiki-dark:#E5C07B;">Pointcut</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;execution(* com.example.service.UserService.createUser())&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">)  </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">// 无参数</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    public</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> void</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> createUserWithNoParams</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {}</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h3 id="within-类型匹配" tabindex="-1"><a class="header-anchor" href="#within-类型匹配"><span>within：类型匹配</span></a></h3><p><strong>定义</strong>：匹配指定类型内的所有方法执行。</p><h4 id="语法结构-1" tabindex="-1"><a class="header-anchor" href="#语法结构-1"><span>语法结构</span></a></h4><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-"><span class="line"><span>within(type-pattern)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h4 id="特点" tabindex="-1"><a class="header-anchor" href="#特点"><span>特点</span></a></h4><ul><li>只能匹配类型，不能匹配方法名、参数、返回值</li><li>比 <code>execution</code> 更简洁，适合匹配整个类或包</li><li>性能比 <code>execution</code> 稍好</li></ul><p><strong>基础示例</strong></p><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-java"><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">@</span><span style="--shiki-light:#A626A4;--shiki-dark:#E5C07B;">Aspect</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">@</span><span style="--shiki-light:#A626A4;--shiki-dark:#E5C07B;">Component</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">public</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> class</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> WithinExamples</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">    </span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    // ========== 1. 匹配特定类 ==========</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    @</span><span style="--shiki-light:#A626A4;--shiki-dark:#E5C07B;">Pointcut</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;within(com.example.service.UserService)&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">)</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    public</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> void</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> withinUserService</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {}</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">    </span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    // ========== 2. 匹配特定包 ==========</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    @</span><span style="--shiki-light:#A626A4;--shiki-dark:#E5C07B;">Pointcut</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;within(com.example.service.*)&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">)  </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">// service 包下所有类</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    public</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> void</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> withinServicePackage</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {}</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">    </span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    @</span><span style="--shiki-light:#A626A4;--shiki-dark:#E5C07B;">Pointcut</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;within(com.example.service..*)&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">)  </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">// service 包及子包下所有类</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    public</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> void</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> withinServicePackageAndSubpackages</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {}</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">    </span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    // ========== 3. 匹配特定类型模式 ==========</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    @</span><span style="--shiki-light:#A626A4;--shiki-dark:#E5C07B;">Pointcut</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;within(com.example.service.*Service)&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">)  </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">// Service 结尾的类</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    public</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> void</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> withinServiceClasses</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {}</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">    </span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    @</span><span style="--shiki-light:#A626A4;--shiki-dark:#E5C07B;">Pointcut</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;within(com.example.service.*ServiceImpl)&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">)  </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">// ServiceImpl 结尾的类</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    public</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> void</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> withinServiceImplClasses</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {}</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">    </span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    // ========== 4. 匹配接口实现类 ==========</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    @</span><span style="--shiki-light:#A626A4;--shiki-dark:#E5C07B;">Pointcut</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;within(com.example.service.UserService+)&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">)  </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">// UserService 及其子类</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    public</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> void</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> withinUserServiceAndSubclasses</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {}</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h3 id="this-代理对象类型匹配" tabindex="-1"><a class="header-anchor" href="#this-代理对象类型匹配"><span>this：代理对象类型匹配</span></a></h3><p><strong>定义</strong>：匹配代理对象是指定类型的连接点。</p><h4 id="语法结构-2" tabindex="-1"><a class="header-anchor" href="#语法结构-2"><span>语法结构</span></a></h4><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-"><span class="line"><span>this(type)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h4 id="特点-1" tabindex="-1"><a class="header-anchor" href="#特点-1"><span>特点</span></a></h4><ul><li>匹配的是代理对象（Proxy）的类型</li><li>与代理方式有关（JDK 动态代理 vs CGLIB 代理）</li><li>JDK 动态代理：代理对象实现接口</li><li>CGLIB 代理：代理对象继承目标类</li></ul><h3 id="target-目标对象类型匹配" tabindex="-1"><a class="header-anchor" href="#target-目标对象类型匹配"><span>target：目标对象类型匹配</span></a></h3><p><strong>定义</strong>：匹配目标对象（被代理的原始对象）是指定类型的连接点。</p><h4 id="语法结构-3" tabindex="-1"><a class="header-anchor" href="#语法结构-3"><span>语法结构</span></a></h4><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-"><span class="line"><span>target(type)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h4 id="特点-2" tabindex="-1"><a class="header-anchor" href="#特点-2"><span>特点</span></a></h4><ul><li>匹配的是目标对象（Target Object）的类型</li><li>与代理方式无关，推荐使用</li><li>比 <code>this</code> 更稳定可靠</li></ul><h3 id="args-参数类型匹配" tabindex="-1"><a class="header-anchor" href="#args-参数类型匹配"><span>args: 参数类型匹配</span></a></h3><h3 id="within-类注解匹配" tabindex="-1"><a class="header-anchor" href="#within-类注解匹配"><span>@within: 类注解匹配</span></a></h3><h3 id="annotation-注解类型匹配" tabindex="-1"><a class="header-anchor" href="#annotation-注解类型匹配"><span>@annotation：注解类型匹配</span></a></h3><p><strong>定义</strong>：匹配带有指定注解的方法。</p><h4 id="语法结构-4" tabindex="-1"><a class="header-anchor" href="#语法结构-4"><span>语法结构</span></a></h4><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-"><span class="line"><span>@annotation(annotation-type)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h4 id="特点-3" tabindex="-1"><a class="header-anchor" href="#特点-3"><span>特点</span></a></h4><ul><li>最常用的注解匹配方式</li><li>可以自定义注解实现灵活的 AOP</li><li>可以绑定注解对象获取注解属性</li></ul><h3 id="target-目标对象注解匹配" tabindex="-1"><a class="header-anchor" href="#target-目标对象注解匹配"><span>@target：目标对象注解匹配</span></a></h3><p><strong>定义</strong>：匹配目标对象（运行时实际类型）带有指定注解的方法。</p><h4 id="语法结构-5" tabindex="-1"><a class="header-anchor" href="#语法结构-5"><span>语法结构</span></a></h4><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-"><span class="line"><span>@target(annotation-type)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h3 id="args-参数注解匹配" tabindex="-1"><a class="header-anchor" href="#args-参数注解匹配"><span>@args：参数注解匹配</span></a></h3><p><strong>定义</strong>：匹配方法参数带有指定注解的方法。</p><h4 id="语法结构-6" tabindex="-1"><a class="header-anchor" href="#语法结构-6"><span>语法结构</span></a></h4><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-"><span class="line"><span>@args(annotation-type, ...)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h2 id="表达式组合" tabindex="-1"><a class="header-anchor" href="#表达式组合"><span>表达式组合</span></a></h2><h3 id="逻辑运算符" tabindex="-1"><a class="header-anchor" href="#逻辑运算符"><span>逻辑运算符</span></a></h3><p>Spring AOP 支持使用逻辑运算符组合多个切点表达式：</p><table><thead><tr><th>运算符</th><th>说明</th><th>示例</th></tr></thead><tbody><tr><td><code>&amp;&amp;</code> (and)</td><td>逻辑与</td><td><code>execution(...) &amp;&amp; within(...)</code></td></tr><tr><td>\`</td><td></td><td>\` (or)</td></tr><tr><td><code>!</code> (not)</td><td>逻辑非</td><td><code>!within(...)</code></td></tr></tbody></table><h2 id="通配符使用" tabindex="-1"><a class="header-anchor" href="#通配符使用"><span>通配符使用</span></a></h2><table><thead><tr><th>通配符</th><th>说明</th><th>示例</th></tr></thead><tbody><tr><td><code>*</code></td><td>匹配任意字符（一个元素）</td><td><code>com.example.service.*</code></td></tr><tr><td><code>..</code></td><td>匹配任意子包或任意参数</td><td><code>com.example.service..*</code></td></tr><tr><td><code>+</code></td><td>匹配子类或实现类</td><td><code>com.example.service.BaseService+</code></td></tr></tbody></table><h2 id="实战案例" tabindex="-1"><a class="header-anchor" href="#实战案例"><span>实战案例</span></a></h2><h2 id="最佳实践" tabindex="-1"><a class="header-anchor" href="#最佳实践"><span>最佳实践</span></a></h2><ol><li><strong>优先使用 <code>execution</code> 和 <code>@annotation</code></strong>：这两种方式最常用且易于理解</li><li><strong>使用 <code>target</code> 而非 <code>this</code></strong>：避免代理方式带来的问题</li><li><strong>合理使用通配符</strong>：明确范围，避免过度匹配</li><li><strong>注意自调用问题</strong>：通过代理对象调用或拆分到不同类</li><li><strong>使用 <code>@Order</code> 控制切面顺序</strong>：确保切面按预期执行</li><li><strong>异步处理耗时操作</strong>：避免影响业务方法性能</li><li><strong>提取公共切点</strong>：提高代码复用性和可维护性</li><li><strong>添加详细日志</strong>：便于调试和问题排查</li></ol><h2 id="切点表达式速查表" tabindex="-1"><a class="header-anchor" href="#切点表达式速查表"><span>切点表达式速查表</span></a></h2><table><thead><tr><th>表达式</th><th>说明</th><th>使用场景</th><th>示例</th></tr></thead><tbody><tr><td><code>execution</code></td><td>方法执行匹配</td><td>最常用，精确匹配方法签名</td><td><code>execution(* com.example.service.*.*(..))</code></td></tr><tr><td><code>within</code></td><td>类型匹配</td><td>匹配指定包或类的所有方法</td><td><code>within(com.example.service..*)</code></td></tr><tr><td><code>this</code></td><td>代理对象类型匹配</td><td>区分代理类型时使用</td><td><code>this(com.example.service.UserService)</code></td></tr><tr><td><code>target</code></td><td>目标对象类型匹配</td><td>推荐使用，与代理方式无关</td><td><code>target(com.example.service.UserService)</code></td></tr><tr><td><code>args</code></td><td>参数类型匹配</td><td>需要绑定参数或匹配运行时类型</td><td><code>args(Long, String)</code></td></tr><tr><td><code>@annotation</code></td><td>方法注解匹配</td><td>基于自定义注解的AOP</td><td><code>@annotation(com.example.annotation.Log)</code></td></tr><tr><td><code>@within</code></td><td>类注解匹配</td><td>匹配带有指定注解的类的所有方法</td><td><code>@within(org.springframework.stereotype.Service)</code></td></tr><tr><td><code>@target</code></td><td>目标对象注解匹配</td><td>运行时对象的类注解匹配</td><td><code>@target(com.example.annotation.Auditable)</code></td></tr><tr><td><code>@args</code></td><td>参数注解匹配</td><td>匹配参数带有指定注解的方法</td><td><code>@args(com.example.annotation.Validated)</code></td></tr></tbody></table>`,61)]))}const r=s(e,[["render",h]]),d=JSON.parse('{"path":"/posts/spring-source/aop/02-Pointcut%20%E8%A1%A8%E8%BE%BE%E5%BC%8F%E6%B7%B1%E5%BA%A6%E8%A7%A3%E6%9E%90.html","title":"Pointcut 表达式深度解析","lang":"en-US","frontmatter":{"title":"Pointcut 表达式深度解析","category":["Spring Source"],"tag":["Spring","AOP"],"order":2,"description":"什么是切点表达式? 切点表达式（Pointcut Expression） 是 Spring AOP 中用于定义\\"在哪里\\"应用切面逻辑的规则。它通过特定的语法来匹配目标方法或类型。 简单来说，切点表达式就像一个过滤器，它告诉 Spring： 哪些类的哪些方法需要被拦截 在什么条件下触发切面逻辑 如何精确定位到目标连接点 核心概念： 连接点（Join Po...","head":[["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"Pointcut 表达式深度解析\\",\\"image\\":[\\"\\"],\\"dateModified\\":\\"2025-11-02T15:09:53.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"LiLiuMing\\",\\"url\\":\\"https://liliuming-truism.github.io\\"}]}"],["meta",{"property":"og:url","content":"https://liliuming-truism.github.io/posts/spring-source/aop/02-Pointcut%20%E8%A1%A8%E8%BE%BE%E5%BC%8F%E6%B7%B1%E5%BA%A6%E8%A7%A3%E6%9E%90.html"}],["meta",{"property":"og:site_name","content":"一个程序员的自我修养"}],["meta",{"property":"og:title","content":"Pointcut 表达式深度解析"}],["meta",{"property":"og:description","content":"什么是切点表达式? 切点表达式（Pointcut Expression） 是 Spring AOP 中用于定义\\"在哪里\\"应用切面逻辑的规则。它通过特定的语法来匹配目标方法或类型。 简单来说，切点表达式就像一个过滤器，它告诉 Spring： 哪些类的哪些方法需要被拦截 在什么条件下触发切面逻辑 如何精确定位到目标连接点 核心概念： 连接点（Join Po..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"en-US"}],["meta",{"property":"og:updated_time","content":"2025-11-02T15:09:53.000Z"}],["meta",{"property":"article:tag","content":"AOP"}],["meta",{"property":"article:tag","content":"Spring"}],["meta",{"property":"article:modified_time","content":"2025-11-02T15:09:53.000Z"}]]},"git":{"createdTime":1762096193000,"updatedTime":1762096193000,"contributors":[{"name":"liuming.li","username":"","email":"liumingli15@163.com","commits":1}]},"readingTime":{"minutes":4.86,"words":1458},"filePathRelative":"posts/spring-source/aop/02-Pointcut 表达式深度解析.md","excerpt":"<h2>什么是切点表达式?</h2>\\n<p><strong>切点表达式（Pointcut Expression）</strong> 是 Spring AOP 中用于定义\\"在哪里\\"应用切面逻辑的规则。它通过特定的语法来匹配目标方法或类型。</p>\\n<p>简单来说，切点表达式就像一个过滤器，它告诉 Spring：</p>\\n<ul>\\n<li>哪些类的哪些方法需要被拦截</li>\\n<li>在什么条件下触发切面逻辑</li>\\n<li>如何精确定位到目标连接点</li>\\n</ul>\\n<p><strong>核心概念</strong>：</p>\\n<ul>\\n<li><strong>连接点（Join Point）</strong>：程序执行过程中的某个特定点，如方法调用、异常抛出等</li>\\n<li><strong>切点（Pointcut）</strong>：匹配连接点的表达式，决定了切面在何处执行</li>\\n<li><strong>切面（Aspect）</strong>：切点和通知（Advice）的组合</li>\\n</ul>","autoDesc":true}');export{r as comp,d as data};
